(this.webpackJsonpindustry=this.webpackJsonpindustry||[]).push([[0],{12:function(e,t,a){e.exports={Place:"_2Ypwy5lUM0lAlLApB1wr_g",active:"_3Uy8T-YqPrcGbmBLG1BmWA"}},14:function(e,t,a){e.exports={Hierarchy:"NBV4ow8Di21cnK7pqGpK6",container:"cN3lwAG6GD51j8dpZE16T",title:"_2x0_WiznIe0lHd_mI4i3WS"}},15:function(e,t,a){e.exports={Store:"_2RmjoY2vh6vp_ytcFzlqox",container:"_25o_D1i-8fdeQpADuQfQnb",title:"H0RAfKBEPnZYROP0N-HDm"}},16:function(e,t,a){e.exports={Table:"_3vKIR2iUPU2NwSyXnMn-wi",delete:"_3COdHtlUHqqCvo1Nzsb5td",edit:"_2DS_woGacRSW-gJLHJnbbK"}},17:function(e,t,a){e.exports={Form:"_2zwZfN0sDiM3e_5bw15CX8",disabled:"_3qnrLtM0rpBibDRMjEwUVJ",cancel:"_1vA1dHWqp9FA81fVSDXuja"}},19:function(e,t,a){e.exports={Ld:"SUwapYpPc4vp9l4kKSIaG",Loader:"_34pxb3XgSd_HSC9dWJyDo"}},23:function(e,t,a){e.exports={App:"_1o-FpbQrR11SDFN-G7O4U3"}},25:function(e,t,a){e.exports=a(41)},30:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var n=a(1),l=a.n(n),r=a(22),c=a.n(r),i=(a(30),a(5)),o=a(6),s=a(8),u=a(7),d=a(23),m=a.n(d),p=a(14),h=a.n(p),f=a(12),v=a.n(f);function E(e,t,a){var n=["fa"];t&&n.push(a);var r={};return e?n.push("fa-home"):(n.push("fa-level-up-alt"),r={transform:"rotate(90deg)"}),l.a.createElement("i",{className:n.join(" "),style:r})}var y=function e(t){if(t.place.parts){var a=[];return t.placeList.forEach((function(e){-1!==t.place.parts.indexOf(e.id)&&a.push(e)})),l.a.createElement("li",{className:v.a.Place},l.a.createElement("ul",null,E(t.isRootPlace,t.currentRoom===t.place,v.a.active),l.a.createElement("span",{onClick:function(){return t.onPlaceClick(t.place)}},t.place.data.name),a.map((function(a,n){return l.a.createElement(e,{key:n,onPlaceClick:t.onPlaceClick,place:a,isRootPlace:!1,placeList:t.placeList,currentRoom:t.currentRoom})}))))}return l.a.createElement("li",{className:v.a.Place},E(t.isRootPlace,t.currentRoom===t.place,v.a.active),l.a.createElement("span",{onClick:function(){return t.onPlaceClick(t.place)}},t.place.data.name))},C=a(19),b=a.n(C),g=function(){return l.a.createElement("div",{className:b.a.Loader},l.a.createElement("div",{className:b.a.Ld},l.a.createElement("div",null,l.a.createElement("div",null),l.a.createElement("div",null),l.a.createElement("div",null),l.a.createElement("div",null),l.a.createElement("div",null),l.a.createElement("div",null))))},k=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).renderRootItems=function(t){return t.map((function(a,n){return-1!==e.props.rootItemsId.indexOf(a.id)?l.a.createElement("ul",{key:n},l.a.createElement(y,{currentRoom:e.props.currentRoom,onPlaceClick:e.props.onPlaceClick,isRootPlace:!0,place:a,placeList:t})):null}))},e}return Object(o.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{className:h.a.Hierarchy},l.a.createElement("div",{className:h.a.title},"\u0421\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438"),l.a.createElement("div",{className:h.a.container},this.props.loading?l.a.createElement(g,null):this.renderRootItems(this.props.places)))}}]),a}(n.Component),I=a(24),N=a(15),R=a.n(N),H=a(16),P=a.n(H),S=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={inventory:[]},e}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(e){this.setState({inventory:e.data})}},{key:"render",value:function(){var e=this;return 0===this.props.data.length?l.a.createElement(l.a.Fragment,null,l.a.createElement("hr",null),l.a.createElement("h2",null,"\u0412 \u043a\u043e\u043c\u043d\u0430\u0442\u0435 \u043d\u0435\u0442 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"),l.a.createElement("hr",null)):l.a.createElement("table",{className:P.a.Table},l.a.createElement("tr",null,l.a.createElement("th",null,"\u2116"),l.a.createElement("th",null,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),l.a.createElement("th",null,"\u041a\u043e\u043b\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),this.props.isLastChild?l.a.createElement("th",null):null),this.props.data.map((function(t,a){return l.a.createElement("tr",{key:a},l.a.createElement("td",null,a+1,"."),l.a.createElement("td",null,t.name),l.a.createElement("td",null,t.count),e.props.isLastChild?l.a.createElement("td",null,l.a.createElement("button",{className:P.a.delete,onClick:function(){return e.props.onDeleteClick(a)}},l.a.createElement("i",{className:"fa fa-trash-alt"})),l.a.createElement("button",{className:P.a.edit,onClick:function(){return e.props.onEditClick(a)}},l.a.createElement("i",{className:"fa fa-pencil-alt"}))):null)})))}}]),a}(n.Component),D=a(9),O=a.n(D),j=a(17),w=a.n(j);function A(e){for(var t=!0,a=arguments.length,n=new Array(a>1?a-1:0),l=1;l<a;l++)n[l-1]=arguments[l];return n.forEach((function(e){t=t&&e})),e&&t}var _=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={name:null,count:null,isValidName:!1,isValidCount:!0,toched:!1},e.componentWillReceiveProps=function(t){t.editing&&e.setState({name:t.editItem.name,count:t.editItem.count,isValidName:!0,isValidCount:!0,toched:!0})},e.onChangeHandler=function(t,a){if(a){var n=t.target.value;e.setState({name:n,toched:!0,isValidName:!!n})}else{var l=t.target.value;e.setState({count:l,toched:!0,isValidCount:l>=1})}},e.clickAddHandler=function(t){e.props.onAddItem(t,e.state.name,e.state.count),e.resetState()},e.clickEditHandler=function(t){e.props.onEditItem(t,e.state.name,e.state.count),e.resetState()},e.resetState=function(){e.setState({name:null,count:null,isValidName:!1,isValidCount:!0,toched:!1})},e}return Object(o.a)(a,[{key:"onCancelClick",value:function(e){this.props.onCancelClick(e),this.resetState()}},{key:"render",value:function(){var e=this;return l.a.createElement("form",{className:w.a.Form},this.props.editing?l.a.createElement("h3",null,"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435:"):l.a.createElement("h3",null,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435:"),l.a.createElement("label",null,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435:",l.a.createElement("input",{type:"text",value:this.state.name?this.state.name:"",onChange:function(t){return e.onChangeHandler(t,!0)}})),l.a.createElement("br",null),l.a.createElement("label",null,"\u041a\u043e\u043b\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e:",l.a.createElement("input",{type:"number",value:this.state.count?this.state.count:"",placeholder:1,min:1,onChange:function(t){return e.onChangeHandler(t,!1)}})),l.a.createElement("br",null),l.a.createElement("button",{className:A(this.state.toched,this.state.isValidName,this.state.isValidCount)?null:w.a.disabled,onClick:this.props.editing?function(t){return e.clickEditHandler(t)}:function(t){return e.clickAddHandler(t)},disabled:!A(this.state.toched,this.state.isValidName,this.state.isValidCount)},this.props.editing?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),this.props.editing?l.a.createElement("button",{className:w.a.cancel,onClick:function(t){return e.onCancelClick(t)}},"\u041e\u0442\u043c\u0435\u043d\u0430"):null)}}]),a}(n.Component),L=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={tableData:[],editing:!1,editItem:null},e.getAllChildrenId=function(t){var a=e.props.places,n=[t.id];return t.parts?(a.forEach((function(a){-1!==t.parts.indexOf(a.id)&&n.push.apply(n,Object(I.a)(e.getAllChildrenId(a)))})),n):n},e.deleteClickHandler=function(t){var a=e.state.tableData[t].id;a&&O.a.firestore().collection("inventory").doc(a).delete().then((function(){e.props.refresh()}))},e.editClickHandler=function(t){e.setState({editing:!0,editItem:e.state.tableData[t]})},e.addItemHandler=function(t,a,n){t.preventDefault();var l=O.a.firestore();l.collection("inventory").doc().set({name:a,count:n||1,place:l.collection("places").doc(e.props.currentRoom.id)}).then((function(){e.props.refresh()}))},e.editItemHandler=function(t,a,n){t.preventDefault();var l=O.a.firestore();l.collection("inventory").doc(e.state.editItem.id).set({name:a,count:n,place:l.collection("places").doc(e.props.currentRoom.id)}).then((function(){e.setState({editing:!1,editItem:null}),e.props.refresh()}))},e.cancelClickHandler=function(t){t.preventDefault(),e.setState({editing:!1,editItem:null})},e}return Object(o.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.currentRoom){var a=[];e.inventory.forEach((function(n){-1!==t.getAllChildrenId(e.currentRoom).indexOf(n.placeId)&&a.push({name:n.data.name,count:n.data.count,id:n.id})})),this.setState({tableData:a})}}},{key:"render",value:function(){return l.a.createElement("div",{className:R.a.Store},l.a.createElement("div",{className:R.a.title},"\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435"),l.a.createElement("div",{className:R.a.container},this.props.currentRoom?this.props.currentRoom.parts?[l.a.createElement("h2",null,this.props.currentRoom.data.name),l.a.createElement(S,{data:this.state.tableData,onDeleteClick:this.deleteClickHandler,isLastChild:!1})]:[l.a.createElement("h2",null,this.props.currentRoom.data.name),l.a.createElement(S,{data:this.state.tableData,onDeleteClick:this.deleteClickHandler,onEditClick:this.editClickHandler,isLastChild:!0}),l.a.createElement(_,{editItem:this.state.editItem,editing:this.state.editing,onAddItem:this.addItemHandler,onEditItem:this.editItemHandler,onCancelClick:this.cancelClickHandler})]:l.a.createElement("h2",null,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u0443")))}}]),a}(n.Component),x=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(i.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={currentPlace:null,rootItemsId:["main","production"],places:[],inventory:[],loadingPlaces:!0,loadingInventory:!0},e.onPlaceClickHandler=function(t){e.setState({currentPlace:t})},e.refreshHandler=function(){O.a.firestore().collection("inventory").get().then((function(t){var a=t.docs.map((function(e){try{return{id:e.id,data:e.data(),placeId:e.data().place.id}}catch(t){return console.log(t),null}}));e.setState({inventory:a.filter((function(e){return null!==e})),loadingInventory:!1})}))},e}return Object(o.a)(a,[{key:"componentDidMount",value:function(){var e=this;O.a.firestore().collection("places").get().then((function(t){var a=t.docs.map((function(e){try{return{id:e.id,data:e.data(),parts:e.data().parts&&e.data().parts.map((function(e){return e.id}))}}catch(t){return console.log(t),null}}));e.setState({places:a,loadingPlaces:!1})})),O.a.firestore().collection("inventory").get().then((function(t){var a=t.docs.map((function(e){try{return{id:e.id,data:e.data(),placeId:e.data().place.id}}catch(t){return console.log(t),null}}));e.setState({inventory:a.filter((function(e){return null!==e})),loadingInventory:!1})}))}},{key:"render",value:function(){return l.a.createElement("div",{className:m.a.App},l.a.createElement(k,{loading:this.state.loadingPlaces&&this.state.loadingPlaces,places:this.state.places,rootItemsId:this.state.rootItemsId,currentRoom:this.state.currentPlace,onPlaceClick:this.onPlaceClickHandler}),l.a.createElement(L,{places:this.state.places,inventory:this.state.inventory,loading:this.state.loadingInventory,currentRoom:this.state.currentPlace,refresh:this.refreshHandler}))}}]),a}(l.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));O.a.initializeApp({apiKey:"AIzaSyD6DnGbVfdJlDJ_pEOUfDfTDJrA8j3lIs8",authDomain:"dv-inventory.firebaseapp.com",databaseURL:"https://dv-inventory.firebaseio.com",projectId:"dv-inventory",storageBucket:"dv-inventory.appspot.com",messagingSenderId:"130062240176",appId:"1:130062240176:web:ecbca5d29b37d25c6cee75"}),c.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(x,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[25,1,2]]]);
//# sourceMappingURL=main.47cd787a.chunk.js.map